{% extends 'layout.html' %}

{% block title %}
    {{ post.title }} - SocialHub
{% endblock %}

{% block content %}
    <div class="breadcrumb">
        <a href="{% url 'posts:list' %}">‚Üê Back to Posts</a>
    </div>

    <section class="postpage">
        <article class="post-detail">
            <!-- Post Header -->
            <div class="post-header">
                <div class="post-meta">
                    <div class="author-info">
                        <span class="author-avatar">üë§</span>
                        <div class="author-details">
                            <span class="author-name">{{ post.author }}</span>
                            <span class="post-date">{{ post.date|date:"F d, Y \a\t g:i A" }}</span>
                        </div>
                    </div>
                    <div class="post-id">#{{ post.id }}</div>
                </div>
            </div>

            <!-- Post Banner -->
            {% if post.banner %}
                <div class="post-banner">
                    <img 
                        class="banner" 
                        src="{{ post.banner.url }}" 
                        alt="{{ post.title }}"
                        loading="lazy"
                    />
                </div>
            {% endif %}

            <!-- Post Content -->
            <div class="post-content">
                <h1 class="post-title">{{ post.title }}</h1>
                
                <div class="post-body">
                    <p>{{ post.body|linebreaks }}</p>
                </div>
            </div>

            <!-- Post Stats -->
            <div class="post-stats">
                <div class="likes-container">
                    <span class="likes-icon">‚ù§Ô∏è</span>
                    <span class="likes-count">{{ post.total_likes }}</span>
                    <span class="likes-label">
                        {% if post.total_likes == 1 %}like{% else %}likes{% endif %}
                    </span>
                </div>
            </div>

            <!-- Post Actions -->
            <div class="post-actions">
                <div class="interaction-buttons">
                    {% if user.is_authenticated %}
                        <form action="{% url 'posts:like-post' post.id %}" method="POST" class="like-form">
                            {% csrf_token %}
                            {% if user in post.likes.all %}
                                <button type="submit" class="interaction-btn unlike-btn" title="Unlike this post">
                                    <span class="btn-icon">üíî</span>
                                    <span class="btn-text">Unlike</span>
                                </button>
                            {% else %}
                                <button type="submit" class="interaction-btn like-btn" title="Like this post">
                                    <span class="btn-icon">‚ù§Ô∏è</span>
                                    <span class="btn-text">Like</span>
                                </button>
                            {% endif %}
                        </form>
                    {% else %}
                        <a href="{% url 'users:login' %}" class="interaction-btn login-prompt" title="Login to like posts">
                            <span class="btn-icon">üîê</span>
                            <span class="btn-text">Login to like</span>
                        </a>
                    {% endif %}
                </div>

                <!-- Author Actions -->
                {% if user == post.author %}
                    <div class="author-actions">
                        <form action="{% url 'posts:delete-post' post.id %}" method="POST" class="delete-form" onsubmit="return confirm('Are you sure you want to delete this post? This action cannot be undone.')">
                            {% csrf_token %}
                            <button type="submit" class="danger-btn" title="Delete this post">
                                <span class="btn-icon">üóëÔ∏è</span>
                                <span class="btn-text">Delete Post</span>
                            </button>
                        </form>
                    </div>
                {% endif %}
            </div>
        </article>
    </section>
{% endblock %}